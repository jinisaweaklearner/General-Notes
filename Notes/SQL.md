### Null
when use `like`, we won't get the record of Null values.

### Like | case insensitive
```
select *
from client.service
where upper(service_name) like '%TEST%';
```

### create table if not exsits
```
create table if not exists table_name (...)
```

### Grant access
```
alter table xx.xxxx owner to your_user_name;
grant select on xx.xxxx to prod_ro;
grant insert, update, delete, truncate on xx.xxxx to prod_create;


grant usage on schema xx to prod_ro;
grant select on all tables in schema xx to prod_ro;
grant create on schema xx to prod_admin;
grant insert, update, delete, truncate on all tables in schema xx to prod_create;
grant all privileges on all functions in schema xx to prod_create;
```

### Auto columns
```
etl_created_by          varchar(100) default CURRENT_USER not null,
etl_created_ts          timestamp    default now()        not null,
etl_id                  integer generated by default as identity
```

### PK
```
portfolio_id varchar(20) not null
    constraint portfolio_pkey primary key,
```

### Year Month
```
select EXTRACT(YEAR FROM transaction_date) AS YEAR,
       EXTRACT(MONTH FROM transaction_date) AS MONTH
from table       
```

### CAST
```
CAST(sum(DailyCount) AS FLOAT) / CAST(count(*) AS FLOAT) as avg_count
```

### TO_CHAT
https://www.postgresql.org/docs/9.6/functions-formatting.html
```
select TO_CHAR(created_date, 'month') AS "month"
from jira.service_desk

output:
september
```

### IF ELSE
```
IF EXISTS ( select * from praemium.fum_stats_summary where as_at_date = '{date_this_week}')
BEGIN
DELETE FROM praemium.fum_stats_summary  WHERE as_at_date = '{date_this_week}';
INSERT INTO praemium.fum_stats_summary(as_at_date,total_fum,source)  values('{date_this_week}','{df_this_summary['Value'].sum()}','Portfolio_Valuation')
END
ELSE
BEGIN
INSERT INTO praemium.fum_stats_summary(as_at_date,total_fum,source)  values('{date_this_week}','{df_this_summary['Value'].sum()}','Portfolio_Valuation')
END
```

### CASE
```
CASE
WHEN AssetClassCode IN ('LOAN', 'CAS') THEN 'UNL'
WHEN s.Exchange_Code IS NULL THEN AssetClassCode
ELSE s.Exchange_Code END AS Exchange_Code,
```